Proceso para subir los datos por año.


Inicialmente se debe ingresar al servidor:
Este paso se repite cada vez que se desea ingresar al servidor


ssh diris@181.177.233.32
pass: pinillos21




Es necesario crear una Base de Datos y realizar las migraciones por cada año que se requiere migrar. (SOLO UNA VEZ)




* Activar el entorno virtual
source /home/diris/vens/diris-haberes/bin/activate
* Dirigirse al proyecto
cd /home/diris/apps/diris-haberes/


* Migración
python manage.py migrate --settings=main.settings.dev --database=haberes_2021


* Creación de super usuario
python manage.py createsuperuser --settings=main.settings.prod --database=haberes_2021








1. Cargar información de ESTABLECIMIENTOS


Nombre del archivo: PLTABEST.xlsx
Esta información se debe cargar Anualmente
* python manage.py shell


* execfile('diris_shell.py') 
* exec(open('diris_shell.py').read())
* load_establecimiento(2021)




2. Carga información de CARGOS


Nombre del archivo: PLTACAR.xlsx
Esta información se debe cargar Anualmente
* python manage.py shell


* execfile('diris_shell.py')
* exec(open('diris_shell.py').read())


* load_cargos(2021)


3. Cargar información de CONCEPTOS


Nombre de archivo:  PLTABCON.xlsx
Esta información se debe cargar mensualmente.


* python manage.py shell


* execfile('diris_shell.py')
* exec(open('diris_shell.py').read())


* load_concepto(1,2021)
* load_concepto(2,2018)
* load_concepto(3,2018)
* …
* load_concepto(8,2014)


4. Carga información de CONSTANCIAS


Nombre del archivo: PLMOVMAE.xlsx
Esta información se debe cargar mensualmente.
* python manage.py shell


* execfile('diris_shell.py') 
* o
* exec(open('diris_shell.py').read())


* load_constancia(1,2018)
* load_constancia(2,2018)
* load_constancia(3,2018)
* …
* load_constancia(2,2021)










------------------------- SQL






SELECT a.monto, a.concepto FROM `constancia_constanciadetalle` as a inner JOIN `trabajador_trabajador` as b on a.trabajador_id = b.id and b.id=438 and a.mes =1